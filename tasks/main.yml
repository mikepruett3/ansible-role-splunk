---
# tasks file for ansible-role-splunk

- name: "Test Access to Proxy Server"
  ansible.builtin.uri:
    url: "{{ proxy_protocol }}://{{ proxy_host }}:{{ proxy_port }}"
    method: GET
    validate_certs: no
    status_code: [200, 400]
  when: proxy != False

- name: "Test Access to Heavy Forwarder Server"
  ansible.builtin.uri:
    url: "https://{{ heavy_forwarder_host }}:{{ heavy_forwarder_port }}"
    method: GET
    validate_certs: no
    status_code: [200, 400]

#- name: "Gather the package facts"
#  ansible.builtin.package_facts:
#    manager: auto
#  when:
#    - ansible_facts['packages'] is not defined

- name: "Include tasks from assert playbook"
  ansible.builtin.include_tasks: assert.yaml

- name: "Include tasks from lookup playbook"
  ansible.builtin.include_tasks: lookup.yaml

- name: "Include tasks from install playbook"
  ansible.builtin.include_tasks: install.yaml
  when:
    - install | bool

- name: "Include tasks from upgrade playbook"
  ansible.builtin.include_tasks: upgrade.yaml
  when:
    - upgrade | bool

#- name: "Include tasks from Debian playbook"
#  ansible.builtin.include_tasks: Debian.yaml
#  when:
#    - ansible_facts['os_family'] == 'Debian'